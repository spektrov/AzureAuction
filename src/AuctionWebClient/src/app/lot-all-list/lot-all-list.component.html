<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/css/bootstrap.min.css" integrity="sha384-Gn5384xqQ1aoWXA+058RXPxPg6fy4IWvTNh0E263XmFcJlSAwiGgFAW/dAiS6JXm" crossorigin="anonymous">

<script src="https://code.jquery.com/jquery-3.2.1.slim.min.js" integrity="sha384-KJ3o2DKtIkvYIK3UENzmM7KCkRr/rE9/Qpg6aAZGJwFDMVNA/GpGFF93hXpG5KkN" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.12.9/umd/popper.min.js" integrity="sha384-ApNbgh9B+Y1QKtv3Rn7W3mgPxhU9K/ScQsAP7hUibX39j7fakFPskvXusvfa0b4Q" crossorigin="anonymous"></script>
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/js/bootstrap.min.js" integrity="sha384-JZR6Spejh4U02d8jOt6vLEHfe/JQGiRRSQQxSfFWpi1MquVdAyjUar5+76PVCmYl" crossorigin="anonymous"></script>


<div class="container d-flex">
  <div class="row">
    <mat-form-field appearance="standard">
      <mat-label>Filter</mat-label>
      <input matInput (keyup)="applyFilter($event)" placeholder="Lots" #input>
    </mat-form-field>

    <div class="mat-elevation-z8">
      <table mat-table [dataSource]="dataSource" matSort>
        <ng-container matColumnDef="id">
          <th style="display: none" mat-header-cell *matHeaderCellDef mat-sort-header="id"></th>
          <td style="display: none" mat-cell *matCellDef="let row"> </td>
        </ng-container>

        <!-- Name Column -->
        <ng-container matColumnDef="name">
          <th  mat-header-cell *matHeaderCellDef mat-sort-header="name"> Name </th>
          <td mat-cell *matCellDef="let row">{{row.name}}</td>
        </ng-container>

        <!-- TimeEnd Column -->
        <ng-container matColumnDef="timeEnd">
          <th mat-header-cell *matHeaderCellDef mat-sort-header="timeEnd"> End of lot </th>
          <td mat-cell *matCellDef="let row"> {{row.timeEnd | date:'dd.MM.yy h:mm:ss'}} </td>
        </ng-container>

        <!-- MaxPrice Column -->
        <ng-container matColumnDef="maxPrice">
          <th mat-header-cell *matHeaderCellDef mat-sort-header="maxPrice"> Current Price </th>
          <td mat-cell *matCellDef="let row"> {{row.maxPrice}} </td>
        </ng-container>

        <!-- Category Column -->
        <ng-container matColumnDef="category.name">
          <th mat-header-cell *matHeaderCellDef> Category </th>
          <td mat-cell *matCellDef="let row"> {{row.category.name}} </td>
        </ng-container>

        <tr mat-header-row *matHeaderRowDef="displayedColumns"></tr>
        <tr mat-row *matRowDef="let row; columns: displayedColumns;" (click)="onSelect(row)"
            [class.demo-row-is-clicked]="row === selectedLot"></tr>

        <!-- Row shown when there is no matching data. -->
        <tr class="mat-row" *matNoDataRow>
          <td class="mat-cell" colspan="4">No data matching the filter "{{input.value}}"</td>
        </tr>
      </table>

      <mat-paginator [pageSizeOptions]="[10, 25, 100]" aria-label="Select page of lots"></mat-paginator>
    </div>
  </div>

  <div class="row">
    <div *ngIf="selectedLot" class="details">
      <h3>You select: {{selectedLot.name}}</h3>

      <div class="align-items-center">
          <div class='col-12'>
            <ngb-carousel *ngFor="let uri of blobsUri">

              <ng-template ngbSlide>
                <img class="photo" src="{{uri}}" alt="photo">
              </ng-template>
<!--              <ng-template ngbSlide>-->
<!--                <img class="photo" src="https://placeimg.com/1080/500/animals" alt="Bangalore Metro">-->
<!--              </ng-template>-->
<!--              <ng-template ngbSlide>-->
<!--                <img class="photo" src="https://placeimg.com/1080/500/animals" alt="Channai Metro">-->
<!--              </ng-template>-->
            </ngb-carousel>
          </div>

        <div class="card" style="">
          <div class="card-body">
            <h5 class="card-title"> {{selectedLot.name}}</h5>
            <p class="card-text">Category: {{selectedLot.category?.name}}</p>
            <p class="card-text">Maximum offered price: <i class="price">{{selectedLot.maxPrice}} $</i> </p>
            <p class="card-text">{{selectedLot.description}}</p>
            <ul class="list-group list-group-flush">
              <li class="list-group-item">  {{selectedLot.timeStart | date:'dd.MM.yy h:mm:ss'}}</li>
              <li class="list-group-item">  {{selectedLot.timeEnd | date:'dd.MM.yy h:mm:ss'}} </li>
              <li class="list-group-item">  Hours left - {{convertDate()}} </li>
            </ul>
          </div>
          <div class="card-footer">
            <div>
              <input type="number" id="bidPrice" [(ngModel)]="bidPrice"
                     min="{{selectedLot.maxPrice}}" placeholder="{{selectedLot.maxPrice}}">
            </div>
            <div class="bid-button" >
              <button class="btn btn-success" [disabled]="convertDate() <= 0" (click)="makeBid()">Make bid</button>
            </div>
            <div *ngIf="errorBid">
              <p class="alert-danger">Error making bid. Someone did bigger bid than you.</p>
            </div>

          </div>
        </div>
      </div>
    </div>
  </div>
</div>
